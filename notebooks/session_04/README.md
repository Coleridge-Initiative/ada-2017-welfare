# Web Scraping and Working with APIs


In this module, we introduce two general ways that one can retrieve data from data sources on the Internet: networked APIs and web scraping. These technical concepts are complementary, but very different. When available, using APIs is greatly preferred to scraping data from the web. This is because an API is intended to offer data via a thoroughly consistent interaction. The internet, however, is a big place. A huge amount of information, even if structured in a useful way, may not be made readily available through an API. In these situations, we turn to web scraping and web crawling to get the data we need.

Before we dive into either of these approaches to data collection, there's a critical underlying concept worth covering first: HTTP. Specifically, it's important to understand the manner in which information is communicated between computers across the internet using HTTP. When we move past HTTP into the applied use of Python packages, keep in mind that both web scraping and APIs are using this same underlying network mechanism. 


## HTTP(S)

HTTP stands for "HyperText Transfer Protocol".  HTTP is a text-based request/response protocol that is used for a substantial amount of the traffic carried by the Internet.  It is the underlying network framework that web browsers use to interact with web servers.  

HTTP is known as a request/response protocol because an HTTP transaction always includes a request and a corresponding response.  You ask for a web page, the server on which the page lives sends you the HTML of the page, so your browser can render it. For example, a web tool might ask for the most recent tweets for a given Twitter user, after which the Twitter server sends back the requested information (as long as you are authenticated and the user is either public or someone you follow).

There is also an encrypted version of the protocol named HTTPS that works the same as HTTP, but over a connection that is encrypted before the request and response are exchanged. There is a currently a big push for transitioning to HTTPS (from just HTTP) within the government (actually outpacing private adoption) following a White House OMB Directive ([M-15-13](https://https.cio.gov)). As another example, The New York Times just began its transition to HTTPS, as you can see below from the green lock icon and the word "Secure", as well as the URL starting with `https:`. 

![HTTPS Example](03-images/https.png)

There are two important advantages of HTTPS to understand:
- Improved Privacy: HTTPS makes it very difficult for third parties to monitor your internet activity.
- Identity Verification: HTTPS ensures that the information recieved by your request originates from the expected domain.

You can read more about [HTTPS and why it is important](https://https.cio.gov/everything/) or the [federal government's progress implementing HTTPS](https://18f.gsa.gov/2017/01/04/tracking-the-us-governments-progress-on-moving-https/).


As we work through web scraping and API invocation below, we will be using Python packages that hide the complexity of making an HTTP(S) request.  It is important to understand HTTP(S), however, so you understand where the complexity lies in web scraping and API calls - each shares the same underlying network mechanism, but the data being sent and received causes one to be much more complicated (scraping) than the other (API calls).

- Based in part on Wikipedia's HTTP article: [https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol](https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol)
- For more details on the actual format of an HTTP request and response, see [Addendum: HTTP Details](#Addendum:-HTTP-Details) below.


# Addendum: HTTP Details

## HTTP request


**Example:**

    GET /index.html HTTP/1.1
    Host: www.example.com
    Accept-Language: en
    
An HTTP request contains:

- a text **request line** that includes the following, in this order, with each separated by a single space:

    - the request method (GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS, CONNECT, PATCH - most common are GET and POST).
    - the URL of the resource you are trying to access.
    - the specific version of HTTP you are using.
    - example:
    
        - `GET /index.html HTTP/1.1`
    
- a **header block** that contains one or more header variables, name-value pairs with name separate from value by a colon and a space.

    - examples:

        - `Host: api.opencalais.com`
        - `Accept-Language: en`
    
- a blank line
- the **body of the request**, if there is one.  POST requests generated by submitting a web form, for example, place all the form inputs in the body of a request, "`<name>=<value>`", one input to a line.